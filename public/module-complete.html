<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modu≈Ç uko≈Ñczony</title>

  <style>
    body{
      margin:0;
      font-family:Arial,sans-serif;
      background:#fff7ef;
      color:#2b1d0e
    }
    .wrap{
      max-width:640px;
      margin:0 auto;
      padding:28px 18px
    }
    .card{
      background:#fffaf4;
      border:1px solid #f1e3d3;
      border-radius:22px;
      padding:26px;
      box-shadow:0 12px 30px rgba(0,0,0,.08);
      text-align:center
    }
    h1{
      margin:0 0 10px;
      font-size:34px
    }
    p{
      margin:0 0 18px;
      font-size:16px;
      color:#6b4e2e;
      line-height:1.5
    }
    .btns{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:16px
    }
    button{
      border:none;
      border-radius:999px;
      padding:14px 18px;
      min-width:180px;
      font-weight:700;
      cursor:pointer;
      font-size:16px
    }
    .primary{
      background:#e67e22;
      color:#fff
    }
    .secondary{
      background:#f1e3d3;
      color:#2b1d0e
    }
    .tiny{
      margin-top:14px;
      font-size:13px;
      color:#8b6a45
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>üéâ Brawo!</h1>
      <p>Uko≈Ñczy≈Çe≈õ modu≈Ç. Chcesz zako≈Ñczyƒá na dzi≈õ czy przej≈õƒá dalej?</p>

      <div class="btns">
        <button class="secondary" onclick="finishToday()">Ko≈Ñczymy na dzi≈õ</button>
        <button class="primary" onclick="nextModule()">Daj kolejny!</button>
      </div>

      <div class="tiny" id="info"></div>
    </div>
  </div>

  <script>
    async function nextModule(){
      try {
        const res = await fetch("/api/next-module", {
          method: "POST",
          credentials: "include"
        });

        if (!res.ok) {
          document.getElementById("info").textContent =
            "‚ùå B≈ÇƒÖd serwera przy pobieraniu kolejnego modu≈Çu.";
          return;
        }

        const { moduleId, level } = await res.json();

        if (!moduleId) {
          document.getElementById("info").textContent =
            "üéâ Uko≈Ñczy≈Ça≈õ wszystkie dostƒôpne modu≈Çy!";
          return;
        }

        // ‚úÖ JEDYNE POPRAWNE PRZEJ≈öCIE DO KURSU
        window.location.href = `/course?level=${level}&module=${moduleId}`;

      } catch (e) {
        document.getElementById("info").textContent =
          "‚ùå B≈ÇƒÖd sieci: " + e.message;
      }
    }

    function finishToday(){
      window.close();
      document.getElementById("info").textContent =
        "Mo≈ºesz zamknƒÖƒá kartƒô. Do zobaczenia!";
    }
  </script>
</body>
</html>
